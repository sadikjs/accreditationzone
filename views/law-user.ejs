<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta name="author" content="Sumit Saha" />
	<meta name="owner" content="learnwithsumit.com" />
	<title>
		<%= title %>
	</title>
	<link rel="shortcut icon" href="./images/favicon.png" />
	<link rel="stylesheet" href="../stylesheets/toastify.css" />
	<link rel="stylesheet" href="../stylesheets/adduser.css" />
	<link rel="stylesheet" href="../stylesheets/acro.css" />
	<link rel="stylesheet" href="../stylesheets/dropdownmenu.css" />
	<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700" rel="stylesheet">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css"
		integrity="sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz" crossorigin="anonymous">
	<script src="./js/toastify.js"></script>
	<script>
		const deleteToast = Toastify({
			text: "You are being logout....",
			duration: 1000,
		})
		function logout() {
			fetch("/", {
				method: "DELETE"

			})
			deleteToast.showToast();

			setTimeout(() => {
				window.location.replace("/");
			}, 1000)
		}
	</script>
</head>

<body>
	<div class="menu">
		<% if(loggedInUser && loggedInUser.username) { %>
			<div class="navbar">
				<div>
					<a href="/"><i class="fas fa-home"></i>Home</a>
				</div>
				<div class="dropdown">
					<a class="dropbtn">All Department
						<i class="fa fa-caret-down"></i>
					</a>
					<div class="dropdown-content">
						<a href="/acro">New User</a>
						<a href="/acro/data">All Data</a>
						<a href="/acro/print/1">Print</a>
					</div>
				</div>
				<div class="dropdown">
					<a class="dropbtn">BCB & Office
						<i class="fa fa-caret-down"></i>
					</a>
					<div class="dropdown-content">
						<a href="/bcb">New User</a>
						<a href="/bcb/data">All Data</a>
						<a href="/bcb/print/1">Print</a>
					</div>
				</div>
				<div class="dropdown">
					<a class="dropbtn">Marketing & Commercial
						<i class="fa fa-caret-down"></i>
					</a>
					<div class="dropdown-content">
						<a href="/marketing">New User</a>
						<a href="/marketing/data">All Data</a>
						<a href="/marketing/print/1">Print</a>
					</div>
				</div>
				<div class="dropdown">
					<a class="dropbtn">Law & Force
						<i class="fa fa-caret-down"></i>
					</a>
					<div class="dropdown-content">
						<a href="/law">New User</a>
						<a href="/law/data">All Data</a>
						<a href="/law/print/1">Print</a>
					</div>
				</div>
				<div class="dropdown">
					<a class="dropbtn">PMOA
						<i class="fa fa-caret-down"></i>
					</a>
					<div class="dropdown-content">
						<a href="/pmoa">New User</a>
						<a href="/pmoa/data">All Data</a>
						<a href="/pmoa/print/1">Print</a>
					</div>
				</div>
				<div class="dropdown">
					<a class="dropbtn">Media
						<i class="fa fa-caret-down"></i>
					</a>
					<div class="dropdown-content">
						<a href="/media">New User</a>
						<a href="/media/data">All Data</a>
						<a href="/media/print/1">Media Print</a>
					</div>
				</div>
				<div class="menu-item">
					<a href="#" onclick="logout()">Logout</a>
				</div>
			</div>
			<% } else { %>
				<div class="menu-item"><a href="/users">Users</a></div>
				<div class="menu-item"><a href="/">Login</a></div>
				<% } %>
	</div>
	<header id="header">
		<nav>
			<div class="container">
				<div class="text-center">
					<a href="/" class="nav-brand text-dark">All Data</a>
					<a href="/htmltopdflaw" style="cursor:pointer; color:darkslateblue">Data-Export</a>
				</div>
			</div>
		</nav>
	</header>
	<!-- Main Site -->
	<main id="site-main">
		<div class="container">
			<form action="/" method="POST">
				<table class="table">
					<thead class="thead-dark">
						<tr>
							<th>FORM NO</th>
							<th>NAME</th>
							<th>DESIGNATION</th>
							<th>ORGANIZATION</th>
							<th>VENUES</th>
							<th>ZONE ONE</th>
							<th>ZONE TWO</th>
							<th>ZONE THREE</th>
							<th>ZONE FOUR</th>
							<th>ZONE FIVE</th>
							<th>ZONE SIX</th>
							<th>NID NO</th>
							<th>PICTURE</th>
							<th>Action</th>
						</tr>
					</thead>
					<tbody>
						<% users.forEach(function(user) { %>
							<tr id="<%= user._id %>">
								<td>
									<%= user.formno %>
								</td>
								<td>
									<%= user.fullname %>
								</td>
								<td>
									<%= user.designation %>
								</td>
								<td>
									<%= user.organization %>
								</td>
								<td>
									<%= user.vanue %>
								</td>
								<td>
									<%= user.zoneone %>
								</td>
								<td>
									<%= user.zonetwo %>
								</td>
								<td>
									<%= user.zonethree %>
								</td>
								<td>
									<%= user.zonefour %>
								</td>
								<td>
									<%= user.zonefive %>
								</td>
								<td>
									<%= user.zonesix %>
								</td>
								<td>
									<%= user.nidno %>
								</td>
								<td>
									<img src="../uploads/lawAvatars/<%= user.image %>" width="40px" height="40px" />
								</td>
								<td>
									<div>
										<form class="left" action="/law/edit/<%=user._id %>" method="get">
											<button type="submit" style="color: black;"><span class="text-gradient">
													<a href="#"><i class="fas fa-pencil-alt">
														</i>
													</a>
												</span>
											</button>
										</form>
										<a href="/law/data" class="right delete"><span class="text-gradient">
												<i class="fas fa-times" style="color: black;"
													onclick="deleteAllUser('<%= user._id %>')">
												</i>
											</span>
										</a>
									</div>
								</td>
							</tr>
							<% }) %>
					</tbody>
				</table>
			</form>
		</div>
	</main>
	<script>
		//Toast
		const deleteUserToast = Toastify({
			text: "User delete successfully",
			duration: 1000,
		});

		const deleteErrorUser = Toastify({
			text: "Could not delete the user!",
			duration: 1000
		})

		//delete document
		async function deleteAllUser(userId) {
			let response = await fetch(`/law/delete/${userId}`, {
				method: "DELETE"
			});

			let result = await response.json();
			if (result.errors) {
				deleteErrorUser.showToast();
			} else {
				deleteUserToast.showToast();
				document.getElementById(userId).remove();
			}
		}
	</script>
</body>

</html>